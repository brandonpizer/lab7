---
title: "Lab 7: Project Introduction and Methods"
authors: 
  - name: Cecily Sperber
    affilication: Colorado State University
    roles: coding
    corresponding: true 
  - name: Libby Prince
    affilication: Colorado State University
    roles: writing 
    corresponding: false
  - name: Brandon Pizer
    affilication: Colorado State University
    roles: research & data collection 
    corresponding: false
format:
  html:
    self-contained: true
execute:
  echo: true
bibliography: references.bib
---
# Introduction 


```{r}
library(tidyverse)
library(tidymodels)
```

# Data
## For our project, we worked with two datasets: one containing carbon emissions data and another with tree cover loss data. Below, we describe the origin, cleaning, and manipulation of the data, followed by three visualizations that help us explore potential patterns
## We used global atmospheric carbon dioxide (CO₂) data from the National Oceanic and Atmospheric Administration (NOAA). This dataset included monthly values of CO₂ concentrations, specifically the "Seasonally Adjusted CO2 Fit (ppm)" column. And for the Tree Cover Loss Data we collected the dataset from Global Forest Watch and it includes worldwide estimates of annual forest cover in hectares. 
```{r}
carbon_data <- read_csv("C:/ESS330/lab7/data/carbon.csv")

treecover_data <- read_csv("C:/ESS330/lab7/data/treecover.csv")
```

# Data Cleaning
## To clean the tree cover loss data we filtered the dataset to include only rows where the country code (iso) was "USA". Then we also filtered for the same time period, 2001–2016, to match the carbon data. Lastly, only relevant columns were kept; year and loss\_\_ha (tree cover loss in hectares).
```{r}
# Tree Data
cleaned_tree_data <- treecover_data %>%
  filter(iso == "USA", year >= 2001, year <= 2016)

head(cleaned_tree_data)
```
## To clean the carbon dataset we removed unnecessary columns and kept only Year, Month, and Seasonally Adjusted CO2 Fit (ppm). We also filtered the data to include only the years from 2001 to 2016. Then we grouped the monthly values by year and calculated the annual average CO₂ level to simplify the analysis.
```{r}
# Carbon Data
cleaned_carbon_data <- carbon_data |>
  select(year = Year, Month, CO2 = `Seasonally Adjusted CO2 Fit (ppm)`) |>
  filter(year >= 2001, year <= 2016) |>
  group_by(year) |>
  summarise(Yearly_Mean = mean(CO2), na.rm = TRUE) |>
  ungroup()
  
```
# Joining Data
```{r}
joined_data <- inner_join(cleaned_carbon_data, cleaned_tree_data, by = "year")
view(joined_data)
```

# Plot Carbon Data
```{r}
ggplot(cleaned_carbon_data, aes(x = year, y = Yearly_Mean)) +
  geom_line(color = "blue", size = 1) +  
  geom_point(color = "red", size = 2) + 
  labs(
    title = "Yearly Mean CO2 Levels (2001-2016)",
    x = "Year",
    y = "CO2 (ppm)"
  ) +
  theme_minimal()
```
## Graph 1: Yearly Mean CO₂ Levels (2001–2016) - Graph 1 displays the average annual CO₂ concentration in the atmosphere over time. A clear upward trend highlights the increase in emissions over the selected years.

# Plot Tree Data
```{r}
ggplot(joined_data, aes(x = year, y = loss__ha)) +
  geom_line(color = "darkgreen", size = 1) +  
  geom_point(color = "orange", size = 2) +  
  labs(
    title = "Annual Tree Cover Loss (2001-2016)",
    x = "Year",
    y = "Tree Cover Loss (ha)"
  ) +
  theme_minimal()  
```
## Graph 2: Annual Tree Cover Loss in the USA (2001–2016) - Graph 2 shows how tree cover loss has varied across the same time period. Peaks in certain years may indicate significant deforestation events or natural disturbances such as wildfires or storms.

# Plot Tree Loss and Carbon 
```{r}
library(scales) 

plot_data <- joined_data %>%
  select(year, Yearly_Mean, loss__ha) %>%
  pivot_longer(cols = c(Yearly_Mean, loss__ha), 
               names_to = "Variable", 
               values_to = "Value")

joined_data <- joined_data %>%
  mutate(scaled_loss = rescale(loss__ha, to = range(Yearly_Mean, na.rm = TRUE)))

ggplot() +
  geom_line(data = joined_data, aes(x = year, y = Yearly_Mean, color = "Carbon Emissions (ppm)"), size = 1) +
  geom_point(data = joined_data, aes(x = year, y = Yearly_Mean, color = "Carbon Emissions (ppm)"), size = 2) +
  geom_line(data = joined_data, aes(x = year, y = scaled_loss, color = "Tree Cover Loss (ha)"), size = 1) +
  geom_point(data = joined_data, aes(x = year, y = scaled_loss, color = "Tree Cover Loss (ha)"), size = 2) +
  scale_y_continuous(
    name = "Carbon Emissions (ppm)", 
    sec.axis = sec_axis(~rescale(., from = range(joined_data$Yearly_Mean, na.rm = TRUE), 
                                    to = range(joined_data$loss__ha, na.rm = TRUE)), 
                        name = "Tree Cover Loss (ha)")
  ) +
  scale_color_manual(values = c("Carbon Emissions (ppm)" = "blue", "Tree Cover Loss (ha)" = "darkgreen")) +
  labs(
    title = "Tree Cover Loss & Carbon Emissions (2001-2016)",
    x = "Year",
    color = "Legend"
  ) +
  theme_minimal()

```
## Graph 3: Correlation of Tree Cover Loss and CO₂ Emissions (2001-2016) - Graph 3 explores the potential relationships between forest loss and atmospheric carbon levels. We created a dual-axis graph for both tree cover loss (scaled to match the range of CO₂) and CO₂ levels which are plotted together by year. This visualization helps us visually assess whether higher deforestation years might be associated with increased carbon emissions.




